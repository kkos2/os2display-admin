if(window.kkSlideRatio||(window.kkSlideRatio={}),window.kkSlideRatio.getRatio||(window.kkSlideRatio.getRatio=function(){const e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;let t=(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)>e?"vertical":"horizontal";return document.querySelectorAll(".half-split").length>0?t="vertical":document.querySelectorAll(".two-rows-portrait").length>0&&(t="horizontal"),t}),window.slidesInSlides||(window.slidesInSlides={}),window.slidesInSlides.setup||(window.slidesInSlides.setup=function(e,t,n,i){e.ikSlide.data={currentSlide:0,subslides:t,num_subslides:n,subslide_duration:i}}),window.slidesInSlides.run||(window.slidesInSlides.run=function(e,t){if(e.options&&e.data&&e.data.subslides){var n=e.data.subslide_duration?e.data.subslide_duration:15,i=function(){t.$timeout((function(){e.data.currentSlide+1>=e.data.num_subslides?t.nextSlide():(e.data.currentSlide++,console.log("Advancing to subslide "+(1+e.data.currentSlide)+" of "+e.data.num_subslides),i())}),1e3*n)};console.log("Slide has "+e.data.num_subslides+" subslides"),e.data.currentSlide=0,0!==e.data.num_subslides?(i(),t.$timeout((function(){var i=n*e.data.num_subslides;t.progressBar.start(i)}),t.fadeTime)):t.$timeout((function(){console.log("no subslides, continuing straight away"),t.nextSlide()}),1e3)}else t.$timeout((function(){t.itkLog.info("Missing sis data, delaying and skipping to buy time the framework to run setup ..."),t.nextSlide()}),1e3)}),!window.slideFunctions.twothreevideo){window.slideFunctions.twothreevideo={setup:e=>{const t=e.ikSlide;let n=[],i=0;t.external_data&&t.external_data.sis_data_slides&&(n=t.external_data.sis_data_slides,i=t.external_data.sis_data_num_slides),e.ikSlide.data={currentSlide:0,subslides:n,num_subslides:i},e.ratio=window.kkSlideRatio.getRatio()},run:(t,n)=>{t.options&&t.data&&t.data.subslides||n.$timeout((function(){n.itkLog.info("Missing sis data, delaying and skipping to buy time the framework to run setup ..."),n.nextSlide()}),1e3),0===t.data.num_subslides&&n.$timeout((function(){console.log("no subslides, continuing straight away"),n.nextSlide()}),1e3),console.log("Slide has "+t.data.num_subslides+" subslides"),(async()=>{t.data.currentSlide=0;for(let i=0;i<t.data.num_subslides;i++){let o=new e;await o.play(`.twothreevideo-id-${t.uniqueId} .twothreevideo-iframe-${i}`),await n.$timeout((function(){t.data.currentSlide++}),500)}n.$timeout((function(){n.nextSlide()}),200)})()}};const e=function(){var e=this;e.glueFrame=null,e.getReadyPlayer=function(n){return new Promise((function(i,o){const a=document.querySelector(n);a||o(`No iframe found with class "${n}"`),e.glueFrame=new t(a,"Player");let s=0,d=setInterval(()=>{s++>=5&&(e.glueFrame.ready?i():o("Timed out waiting for player ready"),clearInterval(d))},800)}))},e.getPlayerProperty=function(t){return new Promise(n=>{e.glueFrame.get(t,e=>{n(e)})})},e.wait=function(e){return new Promise(t=>{setTimeout(t,e)})},e.startPlaying=function(){return new Promise(t=>{e.glueFrame.set("playing",!0),e.wait(3e3).then(()=>{e.getPlayerProperty("video_title").then(e=>{console.log("Started player for "+e)})}).then(()=>{t()})})},e.monitor=function(){return new Promise((function(t,n){let i=0,o=0,a=setInterval((function(){e.getPlayerProperty("error").then(e=>{if(e&&""!==e)throw e}).then(()=>e.getPlayerProperty("currentTime").then(e=>{if(void 0!==e&&e===i?o++:o=0,o>5)throw`Player did not progress after seconds '${i}'`;i=e,console.log("@ "+i)})).then(()=>e.getPlayerProperty("ended").then(e=>{void 0!==e&&!0===e&&(clearInterval(a),console.log("Player finished"),t())})).catch(t=>{e.glueFrame.set("playing",!1),console.log("Error playing video. Stopping."),clearInterval(a),n(t)})}),2e3)}))},e.play=function(t){return e.getReadyPlayer(t).then(()=>e.startPlaying()).then(()=>e.monitor()).catch(e=>{console.log(e)}).then(()=>{e.glueFrame.destroy()})};var t=function(e,t){var n=this;n.glueframe="1.1.3";var i=(""+e.src).split("/").slice(0,3).join("/"),o=i==(""+window.location).split("/").slice(0,3).join("/")?"object":void 0!==window.postMessage?"post":"none";n.ready=!1;var a=window.setInterval((function(){this.ready||"object"!==o?this.ready||"post"!==o||n.get("bootstrapped",(function(e){e&&(n.ready=!0,window.clearInterval(a),c())}),!0):e.contentWindow[t]&&e.contentWindow[t].bootstrapped&&(n.ready=!0,window.clearInterval(a),c())}),100);n.glueFrameId=Math.floor((new Date).getTime()*Math.random());var s=0,d={},r=function(e,t){var i=n.glueFrameId+"_"+ ++s;if("function"==typeof e)d[i]=e;else if(t)throw"GlueFrame: Callback not registered correctly.";return i},l=[],u=function(e,t){l.push({method:e,args:t})},c=function(){for(var e=0;e<l.length;e+=1){var t=l[e];t.method.apply(null,t.args)}l=[],n.set("queuedEventsProcessed",!0)};n.get=function(a,s,l){if(n.ready||l){var c=r(s,!0);if("object"===o){var w=e.contentWindow[t].get.apply(null,[a]);void 0!==d[c]&&d[c].apply(null,[w])}else if("post"===o){var f={f:"get",args:[a],cbId:c};e.contentWindow.postMessage(JSON.stringify(f),l?"*":i)}}else u(n.get,[a,s])},n.set=function(a,s,l){if(n.ready){var c=r(l,!1);if("object"===o){var w=e.contentWindow[t].set.apply(null,[a,s]);void 0!==d[c]&&d[c].apply(null,[w])}else if("post"===o){var f={f:"set",args:[a,s],cbId:c};e.contentWindow.postMessage(JSON.stringify(f),i)}}else u(n.set,[a,s,l])},n.bind=function(a,s,d){d=d||!1;if(n.ready){var l=r(s,!0);if("object"===o)e.contentWindow[t].bind.apply(null,[a,s,d]);else if("post"===o){var c={f:"bind",args:[a],cbId:l,triggerQueue:d};e.contentWindow.postMessage(JSON.stringify(c),i)}}else u(n.bind,[a,s,!0])},n.fire=function(a,s){if(n.ready){if("object"===o)return e.contentWindow[t].fire.apply(null,[a,s]);if("post"===o){var d={f:"fire",args:[a,s]};e.contentWindow.postMessage(JSON.stringify(d),i)}}else u(n.fire,[a,s])},n.destroy=function(){window.addEventListener?window.removeEventListener("message",w,!1):window.detachEvent("onmessage",w),window.clearInterval(a),d={}};var w=function(e){if(e.origin===i){var t;try{t=JSON.parse(e.data)}catch(e){}void 0!==t&&void 0!==t.cbId&&"function"==typeof d[t.cbId]&&d[t.cbId].apply(null,[t.a,t.b])}};window.addEventListener?window.addEventListener("message",w,!1):window.attachEvent("onmessage",w)};"function"==typeof window.onGlueFrameAvailable&&window.onGlueFrameAvailable(t),"undefined"!=typeof module&&module.exports&&(module.exports=t)}}